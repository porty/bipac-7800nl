<%WebStr(menu.sr,_o)%>
<%WebStr(comm.sr,_o)%>
<%WebStr(lan.sr,_o)%>
<%WebStr(cus.sr,_o)%>
<html>
<head>
<meta http-equiv="content-type" content="text/html; charset=<%WebStr(cus,CHARSET)%>">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta http-equiv="Cache-Control" content="no-cache">
<link rel="stylesheet" type="text/css" href="7800N.css">
<script language="javascript" src="util.js"></script>
<script language='javascript'>
<!-- hide
var Entries=[<%RipGet()%>];
function applyClick(riplist) {
	var lst = '';
	var loc = 'ripcfg.cmd?action=apply';
	if(Entries.length==0)
	{
		alert("<%WebStr(lan,WAN_RIP_ERR)%>");
		return;
	}
	with ( document.forms[0] ) {
		if (riplist.length > 0) {
		for (var i = 0; i < riplist.length; i++)
			if ( riplist[i].checked == true )
			lst = lst + riplist[i].value + '|' + ripVer[i].value + '|' + ripOp[i].value + '|' +  '1' + ', ';
			else
			lst = lst + riplist[i].value + '|' + ripVer[i].value + '|' + ripOp[i].value + '|' + '0' + ', ';
		}else if ( riplist.checked == true )
			lst = lst + riplist.value + '|' + ripVer.value + '|' + ripOp.value +  '|' + '1' + ', ';
		else if ( riplist.checked == false )
			lst = lst + riplist.value + '|' + ripVer.value + '|' + ripOp.value +  '|' + '0' + ', ';
	}
	loc += '&ripLst=' + lst;
	loc += '&sessionKey=<%ejGetOther(sessionKey)%>';
	var code = 'location="' + loc + '"';
	eval(code);
}
function showRIP()
{
	for(var i=0; i<Entries.length; i++)
	{
		document.write("<tr><td class=listrow align=center>"+Entries[i][0]+"</td><td class=listrow align=center>");
		document.write("<select name='ripVer' ");
		if(Entries[i][3]=="0")  document.write("disabled");
		document.write("><option value='1' ");
		if(Entries[i][1]=="1")  document.write("selected");
		document.write(">1</option><option value='2' ");
		if(Entries[i][1]=="2")  document.write("selected");
		document.write(">2</option><option value='3' ");
		if(Entries[i][1]=="3")  document.write("selected");
		document.write("><%WebStr(lan,BOTH)%></option></select></td>");

		document.write("<td class=listrow align=center><select name='ripOp' ");
		if(Entries[i][3]=="0")  document.write("disabled");
		document.write("><option value='0' ");
		if(Entries[i][2]=="0")  document.write("selected");
		document.write("><%WebStr(lan,ACTIVE)%></option><option value='1' ");
		if(Entries[i][2]=="1")  document.write("selected");
		document.write("><%WebStr(lan,PASSIVE)%></option></select></td>");

		document.write("<td class=listrow align=center><input type='checkbox' name='riplist' value="+Entries[i][0]+" onClick=enRip('"+i+"');");
		if(Entries[i][3]=="1")  document.write(" checked");
		document.write("></td></tr>");
	}
}
function enRip(idx)
{
	with ( document.forms[0] ) {
		var fg;
		for(var i=0; i<Entries.length; i++)
		{
			if(Entries.length ==1)
			{
				fg=(riplist.checked)?false:true;
				ripVer.disabled=fg;
				ripOp.disabled=fg;
			}else{
				fg=(riplist[i].checked)?false:true;
				ripVer[i].disabled=fg;
				ripOp[i].disabled=fg;
			}
		}
	}
}
function frmLoad()
{
	with ( document.forms[0] ) {
		var fg=(Entries.length ==0)?true:false;
		bApply.disabled=fg;
		bCancel.disabled=fg;
	}
}
// done hiding -->
</script>
</head>
<body onload=frmLoad()>
<form>
<table class="mframe" border="1" cellpadding="0" cellspacing="3" scrolling="no" style="border-collapse: collapse" bordercolor="#CCCCCC" width="100%">
<tr><td class="mframe">
	<table class="titletbl" cellpadding="0" cellspacing="0" width="100%">
	<tr>
	<td class="titletbl1"></td>
	<td class="titletbl2 capstr"><%WebStr(menu,MENU_ADVANCED_SETUP)%></td>
	<td class="titletbl3"></td>
	</tr>
	</table>
</td></tr>
<tr><td class="mframe">
<table class="sframe" cellspacing="0" cellpadding="0" width="98%" align="center">
<tr><td class="sframe_title headline"><img src="dot5s.gif" width="11" height="11"><%WebStr(menu,MENU_RT_RIP)%></td></tr>
<tr><td class="sframe">
	<table class="cfgframe" cellspacing="2" cellpadding="0" width="100%" align="center">	
		<tr><td colspan=4 class="header"><%WebStr(comm,PARM)%></td></tr>
		<tr><td colspan=4 class="header"><%WebStr(lan,RIP_HINT)%></td></tr>
		<tr><td class="listhead" align=center width="25%"><%WebStr(comm,INTERFACE)%></td>
			<td class="listhead" align=center width="25%"><%WebStr(lan,VERSION)%></td>
			<td class="listhead" align=center width="25%"><%WebStr(lan,OPERATION)%></td>
			<td class="listhead" align=center width="25%"><%WebStr(comm,ENABLE)%></td>
		</tr>
<script language="javascript">
<!-- hide
showRIP();
// done hiding -->
</script>
		<tr><td colspan="4" class="btnline">
			<input type="button" name="bApply" value="<%WebStr(comm,APPLY)%>" onClick="applyClick(this.form.riplist)">&nbsp;
			<input type="button" name="bCancel" value="<%WebStr(comm,CANCEL)%>" onclick="reset();"></td></tr>
	</table><!-- cfgframe -->
</td></tr>
</table><!-- sframe -->
</td></tr>
</table><!-- mframe -->
</form>
</body>
</html>
<%WebStr(menu.sr,_c)%>
<%WebStr(comm.sr,_c)%>
<%WebStr(lan.sr,_c)%>
<%WebStr(cus.sr,_c)%>
